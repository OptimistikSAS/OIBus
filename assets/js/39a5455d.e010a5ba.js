"use strict";(self.webpackChunkdoc_oibus=self.webpackChunkdoc_oibus||[]).push([[6119],{8600:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>c});var s=t(4848),o=t(8453);const i={sidebar_position:2},a="OIBus to OIBus communication",r={id:"guide/advanced/oibus-to-oibus",title:"OIBus to OIBus communication",description:"Context",source:"@site/versioned_docs/version-v2/guide/advanced/oibus-to-oibus.md",sourceDirName:"guide/advanced",slug:"/guide/advanced/oibus-to-oibus",permalink:"/docs/v2/guide/advanced/oibus-to-oibus",draft:!1,unlisted:!1,tags:[],version:"v2",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"guideSidebar",previous:{title:"OIBus security",permalink:"/docs/v2/guide/advanced/oibus-security"},next:{title:"Data rate estimation and cache sizing",permalink:"/docs/v2/guide/advanced/oibus-data-rate"}},l={},c=[{value:"Context",id:"context",level:2},{value:"Data",id:"data",level:2},{value:"Set up a North connector OIConnect in OIBus1",id:"set-up-a-north-connector-oiconnect-in-oibus1",level:3},{value:"Set up an External source in OIBus2",id:"set-up-an-external-source-in-oibus2",level:3},{value:"Logs",id:"logs",level:2},{value:"Loki through another OIBus",id:"loki-through-another-oibus",level:3},{value:"Health Signal",id:"health-signal",level:2}];function h(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"oibus-to-oibus-communication",children:"OIBus to OIBus communication"}),"\n",(0,s.jsx)(n.h2,{id:"context",children:"Context"}),"\n",(0,s.jsxs)(n.p,{children:["Sometimes, PLCs or databases are only accessible in a private network. Let's call it the ",(0,s.jsx)(n.strong,{children:"industrial network"}),". This\nnetwork often exists inside or beside another network ; let's call it the ",(0,s.jsx)(n.strong,{children:"office network"}),".\nTwo options exist to access these data:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Allow connections to each data source from the OIBus machine (which is in the office network, outside the industrial\nnetwork) through the firewall"}),"\n",(0,s.jsx)(n.li,{children:"Install one OIBus in the industrial network and one OIBus in the office network.Manage a single communication between\nthe two networks."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The first option is acceptable if you have only one machine on which to install OIBus, but it involves more network\nsettings to manage and risk the exposing of your machines.\nThe second option is preferable. Indeed, the first OIBus in the industrial network - OIBus1 - can access the machine in\nthe same network, and send data to the office network through a single connection allowed in the firewall (from OIBus1\nto OIBus2)."}),"\n",(0,s.jsx)(n.p,{children:"Let's see how to set up this communication."}),"\n",(0,s.jsx)(n.h2,{id:"data",children:"Data"}),"\n",(0,s.jsx)(n.h3,{id:"set-up-a-north-connector-oiconnect-in-oibus1",children:"Set up a North connector OIConnect in OIBus1"}),"\n",(0,s.jsx)(n.p,{children:"OIConnect is very useful when one OIBus has no internet access (because it is isolated in an industrial network) but\ncan communicate to another OIBus which is in another network with internet access."}),"\n",(0,s.jsxs)(n.p,{children:["In this case, let's keep the default endpoints ",(0,s.jsx)(n.code,{children:"/engine/addValues"})," and ",(0,s.jsx)(n.code,{children:"/engine/addFile"})," for values and file endpoints\nrespectively.\nThe host could be something like ",(0,s.jsx)(n.code,{children:"http://1.2.3.4:2223"})," where 1.2.3.4 is the IP address and 2223 is the port of the\nsecond OIBus. Be careful to authorize remote connection in the second OIBus Engine settings in the\n",(0,s.jsx)(n.a,{href:"../engine/access",children:"IP Filter section"})," and to use the appropriate username and password (using Basic\nAuthentication). In this case, the OIBus username and password must be used (by default, admin and pass)."]}),"\n",(0,s.jsx)(n.h3,{id:"set-up-an-external-source-in-oibus2",children:"Set up an External source in OIBus2"}),"\n",(0,s.jsx)(n.p,{children:"On the second OIBus, if you have a North connector with no subscription, the data will automatically be sent to the\nNorth."}),"\n",(0,s.jsxs)(n.p,{children:["However, if you want a North to subscribe to a specific external source, you must declare an additional external source\nin the ",(0,s.jsx)(n.a,{href:"../engine/external-sources",children:"Engine settings"}),". Its name must follow the syntax of the ",(0,s.jsx)(n.a,{href:"../north-connectors/oiconnect#query-param",children:"name query\nparam"}),", for example ",(0,s.jsx)(n.code,{children:"MyOIBus:MyOIConnect"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"The North connector can now subscribe to this specific external source."}),"\n",(0,s.jsx)(n.h2,{id:"logs",children:"Logs"}),"\n",(0,s.jsx)(n.h3,{id:"loki-through-another-oibus",children:"Loki through another OIBus"}),"\n",(0,s.jsxs)(n.p,{children:["To send logs to OIBus2, go to the Engine page in the ",(0,s.jsx)(n.em,{children:"Loki logs"})," section, and specify the OIBus2 address in the\n",(0,s.jsx)(n.strong,{children:"Host"})," field and its associated endpoint. For example: ",(0,s.jsx)(n.code,{children:"http://1.2.3.4:2223/logs"}),".\nOIBus2 uses Basic Auth. Keep empty the token address field and fill the username and password used to connect to OIBus2."]}),"\n",(0,s.jsxs)(n.p,{children:["If the loki level set in OIBus1 is ",(0,s.jsx)(n.strong,{children:"info"}),", only info and above levels will be sent to OIBus2. In OIBus2, if the\nconsole and file levels are set to ",(0,s.jsx)(n.strong,{children:"error"}),", only error levels will be logged on the console and\nfile. However, if the loki level is set to ",(0,s.jsx)(n.strong,{children:"info"})," too, all the logs received from OIBus1 will be sent to this loki\nendpoint."]}),"\n",(0,s.jsx)(n.h2,{id:"health-signal",children:"Health Signal"}),"\n",(0,s.jsx)(n.p,{children:"When the health signal is triggered through the logs, it follows the logic when sending logs to loki. Nothing else\nhas to be done."}),"\n",(0,s.jsx)(n.p,{children:"When the health signal is triggered though an HTTP request, it can be sent to OIBus2 to be forwarded to its own HTTP\nhealth signal. If the OIBus2 HTTP health signal is disabled, the OIBus1 signal will only be stored in OIBus2 logs but\nnot forwarded to another HTTP endpoint."}),"\n",(0,s.jsxs)(n.p,{children:["The endpoint to use for HTTP health signal to another OIBus is ",(0,s.jsx)(n.code,{children:"/engine/aliveSignal"}),"."]})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var s=t(6540);const o={},i=s.createContext(o);function a(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);