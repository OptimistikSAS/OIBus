"use strict";(globalThis.webpackChunkdoc_oibus=globalThis.webpackChunkdoc_oibus||[]).push([[1402],{28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>s});var i=n(96540);const r={},o=i.createContext(r);function a(e){const t=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(o.Provider,{value:t},e.children)}},51222:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"guide/installation/disk-image","title":"Automated OIBus Installation","description":"Objective","source":"@site/docs/guide/installation/disk-image.mdx","sourceDirName":"guide/installation","slug":"/guide/installation/disk-image","permalink":"/docs/guide/installation/disk-image","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"guideSidebar","previous":{"title":"OIAnalytics Registration","permalink":"/docs/guide/installation/oianalytics"},"next":{"title":"Migrate to v3","permalink":"/docs/guide/installation/migrate"}}');var r=n(74848),o=n(28453);const a={sidebar_position:4},s="Automated OIBus Installation",l={},c=[{value:"Objective",id:"objective",level:2},{value:"Disk Image Preparation",id:"disk-image-preparation",level:2},{value:"Sample Implementation",id:"sample-implementation",level:3},{value:"Sample Installation Script",id:"sample-installation-script",level:2},{value:"Usage",id:"usage",level:3}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"automated-oibus-installation",children:"Automated OIBus Installation"})}),"\n",(0,r.jsx)(t.h2,{id:"objective",children:"Objective"}),"\n",(0,r.jsx)(t.p,{children:"This automated installation procedure enables efficient, large-scale OIBus deployments by combining secure installation with standardized initial configuration."}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Key Benefits:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Scalable deployment"})," across multiple machines"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Consistent configurations"})," from first launch"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Immediate remote management"})," via ",(0,r.jsx)(t.a,{href:"/docs/guide/installation/oianalytics",children:"OIAnalytics"})]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Reduced manual effort"})," and minimized setup errors"]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"Perfect for enterprise environments, industrial implementations, or any scenario requiring multiple OIBus instances with uniform configurations."}),"\n",(0,r.jsx)(t.h2,{id:"disk-image-preparation",children:"Disk Image Preparation"}),"\n",(0,r.jsx)(t.h3,{id:"sample-implementation",children:"Sample Implementation"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["Extract the OIBus installation ZIP to ",(0,r.jsx)(t.code,{children:"C:\\Program Files\\OIBus"})]}),"\n",(0,r.jsx)(t.li,{children:"Add your installation script to this directory"}),"\n",(0,r.jsx)(t.li,{children:"Configure the script to run on startup (only if OIBus isn't already installed)"}),"\n",(0,r.jsx)(t.li,{children:"Create a disk image (without OIBus installed) for deployment"}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"Additional curl commands can be added to the installation script for initial setup. Specific configurations will be managed through OIAnalytics."}),"\n",(0,r.jsx)(t.h2,{id:"sample-installation-script",children:"Sample Installation Script"}),"\n",(0,r.jsxs)(t.p,{children:["The following script automates the installation, startup, and registration of OIBus. The ",(0,r.jsx)(t.code,{children:"OIANALYTICS_URL"})," can be\ncustomized to point to your OIAnalytics instance. If you don\u2019t use OIAnalytics, you can omit the registration step."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-batch",children:'@echo off\n:: This script checks if OIBus is already installed. If not, it waits for the network, installs OIBus, waits for the service to start, and registers it.\n\n:: Path to the installation script (assumes it is in the same folder as this script)\n:: Set the path before et local\nset INSTALL_SCRIPT_PATH=%~dp0install.bat\n\nsetlocal enabledelayedexpansion\n\nset USERNAME=admin\nset PASSWORD=pass\nset OIANALYTICS_URL=https://instance.optimistik.fr/\n\n:: Default values\nset n=OIBus\nset c=C:\\OIBusData\n\n:PARSE_PARAMETERS\nif "%~1"=="" goto PARSE_PARAMETERS_DONE\nif "%~1"=="-n" (\n    set "n=%~2"\n    shift\n    shift\n    goto PARSE_PARAMETERS\n)\nif "%~1"=="-c" (\n    set "c=%~2"\n    shift\n    shift\n    goto PARSE_PARAMETERS\n)\nshift\ngoto PARSE_PARAMETERS\n:PARSE_PARAMETERS_DONE\n\n:: Check if running as Admin\nnet session >nul 2>&1\nif %errorLevel% neq 0 (\n    echo This script must be run as Administrator.\n    exit /b 1\n)\n\n:: Check if OIBus service is already installed\nsc query "%n%" >nul 2>&1\nif %errorlevel% equ 0 (\n    echo %n% service is already installed. Skipping installation.\n    goto END\n)\n\n:: Wait for the network service to be running\necho Waiting for the network service to start...\n:WAIT_FOR_NETWORK\nsc query "Dnscache" | find "RUNNING" >nul\nif %errorlevel% neq 0 (\n    timeout /t 5 >nul\n    goto WAIT_FOR_NETWORK\n)\necho Network service is running.\n\n:: Create data directory if it doesn\'t exist\nif not exist "%c%" mkdir "%c%"\n\n:: Call the installation script, passing the data directory as a parameter\ncall "%INSTALL_SCRIPT_PATH%" -c "%c%" -n "%n%"\nif %errorlevel% neq 0 (\n    echo Error: %n% installation failed.\n    exit /b %errorlevel%\n)\n\n:: Wait for the OIBus service to be running\necho Waiting for %n% service to start...\n:WAIT_FOR_OIBUS\nfor /f "tokens=3 delims=: " %%H in (\'sc query "%n%" ^| findstr "STATE"\') do (\n    if /I "%%H" NEQ "RUNNING" (\n        timeout /t 5 >nul\n        goto WAIT_FOR_OIBUS\n    )\n)\necho %n% service is now running.\n\n:: Wait for the OIBus web server to be up\necho Waiting for %n% web server to be up...\n:WAIT_FOR_WEB\ncurl --silent --output NUL --fail http://localhost:2223/api\nif %errorlevel% neq 0 (\n    timeout /t 5 >nul\n    goto WAIT_FOR_WEB\n)\necho %n% web server is now up.\n\n:: Execute the curl command to create North connector\necho Creating North connector...\ncurl --location --user %USERNAME%:%PASSWORD% "http://localhost:2223/api/north" ^\n--header "Content-Type: application/json" ^\n--header "Accept: application/json" ^\n--data "{\\"name\\": \\"North OIAnalytics\\", \\"type\\": \\"oianalytics\\", \\"description\\": \\"\\", \\"enabled\\": true, \\"settings\\": {\\"useOiaModule\\": true, \\"timeout\\": 15000, \\"compress\\": false}, \\"caching\\": {\\"archive\\": {\\"retentionDuration\\": 0, \\"enabled\\": false}, \\"error\\": {\\"retentionDuration\\": 0, \\"retryCount\\": 3, \\"retryInterval\\": 5000}, \\"throttling\\": {\\"maxNumberOfElements\\": 10000, \\"maxSize\\": 0, \\"runMinDelay\\": 200}, \\"trigger\\": {\\"numberOfFiles\\": 1, \\"numberOfElements\\": 1, \\"scanModeName\\": \\"Every minute\\", \\"scanModeId\\": \\"\\"}}, \\"subscriptions\\": [], \\"transformers\\": []}"\necho.\nif %errorlevel% neq 0 (\n    echo Error: Failed to create North connector.\n    exit /b %errorlevel%\n)\n\n:: Execute the curl command to create South connector\necho Creating South connector...\ncurl --location --user %USERNAME%:%PASSWORD% "http://localhost:2223/api/south" ^\n--header "Content-Type: application/json" ^\n--header "Accept: application/json" ^\n--data "{\\"name\\": \\"Modbus\\", \\"type\\": \\"modbus\\", \\"description\\": \\"\\", \\"enabled\\": true, \\"settings\\": {\\"host\\": \\"127.0.0.1\\", \\"port\\": 502, \\"connectTimeout\\": 10000, \\"retryInterval\\": 10000, \\"slaveId\\": 1, \\"addressOffset\\": \\"modbus\\", \\"endianness\\": \\"big-endian\\", \\"swapBytesInWords\\": false, \\"swapWordsInDWords\\": false}, \\"items\\": []}"\necho.\nif %errorlevel% neq 0 (\n    echo Error: Failed to create South connector.\n    exit /b %errorlevel%\n)\n\n:: Execute the curl command to create a scan mode\necho Creating scan mode...\ncurl --location --user %USERNAME%:%PASSWORD% "http://localhost:2223/api/scan-modes" ^\n--header "Content-Type: application/json" ^\n--header "Accept: application/json" ^\n--data "{\\"name\\": \\"Daily Backup Scan\\", \\"description\\": \\"Scans for new backup data every day at midnight\\", \\"cron\\": \\"0 0 * * *\\"}"\necho.\nif %errorlevel% neq 0 (\n    echo Error: Failed to create scan mode.\n    exit /b %errorlevel%\n)\n\n:: Execute the curl command to register OIBus\necho Registering OIBus...\ncurl --location --user %USERNAME%:%PASSWORD% "http://localhost:2223/api/oianalytics/register" ^\n--header "Content-Type: application/json" ^\n--data "{\\"host\\": \\"%OIANALYTICS_URL%\\", \\"useProxy\\": false, \\"proxyUrl\\": \\"\\", \\"proxyUsername\\": \\"\\", \\"proxyPassword\\": \\"\\", \\"acceptUnauthorized\\": false, \\"commandRefreshInterval\\": 60, \\"commandRetryInterval\\": 10, \\"messageRetryInterval\\": 10, \\"commandPermissions\\": {\\"setpoint\\": true, \\"testNorthConnection\\": true, \\"deleteNorth\\": true, \\"updateNorth\\": true, \\"createNorth\\": true, \\"testSouthItem\\": true, \\"testSouthConnection\\": true, \\"createOrUpdateSouthItemsFromCsv\\": true, \\"deleteSouth\\": true, \\"updateSouth\\": true, \\"createSouth\\": true, \\"testHistorySouthItem\\": true, \\"testHistorySouthConnection\\": true, \\"testHistoryNorthConnection\\": true, \\"createOrUpdateHistoryItemsFromCsv\\": true, \\"deleteHistoryQuery\\": true, \\"updateHistoryQuery\\": true, \\"createHistoryQuery\\": true, \\"deleteCertificate\\": true, \\"updateCertificate\\": true, \\"createCertificate\\": true, \\"deleteIpFilter\\": true, \\"updateIpFilter\\": true, \\"createIpFilter\\": true, \\"deleteScanMode\\": true, \\"updateScanMode\\": true, \\"createScanMode\\": true, \\"updateRegistrationSettings\\": true, \\"updateEngineSettings\\": true, \\"regenerateCipherKeys\\": true, \\"restartEngine\\": true, \\"updateVersion\\": true}}"\necho.\nif %errorlevel% neq 0 (\n    echo Error: Failed to register OIBus.\n    exit /b %errorlevel%\n)\n\n:END\n\n'})}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["For a complete list of available endpoints, visit the ",(0,r.jsx)(t.a,{href:"/docs/api/",children:"API documentation page"}),"."]})}),"\n",(0,r.jsx)(t.h3,{id:"usage",children:"Usage"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-batch",children:'.\\mass-install.bat -n "OIBus" -c "C:\\OIBusData"\n'})})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);