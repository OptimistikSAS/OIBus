!function(e){var r={};function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,r,t){o.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,r){if(1&r&&(e=o(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)o.d(t,n,function(r){return e[r]}.bind(null,n));return t},o.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(r,"a",r),r},o.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},o.p="",o(o.s=19)}([function(e,r){e.exports=require("koa-router")},function(e,r){e.exports=require("minimist")},function(e,r,o){const t=o(1);e.exports={parseArgs:()=>{const e=t(process.argv.slice(2));return(({config:e="./fTbus.config.json"})=>!!e||(console.error("No config file specified, exemple: --config ./config/config.json"),!1))(e)?e:null}}},function(e,r){e.exports=require("cron")},function(e,r){e.exports=require("fs")},function(e,r){e.exports={getNode:function(e){const{query:r}=e.request,{node:o}=r,t=e.request.header.authorization||"";if(!t.startsWith("Basic "))throw new Error("The authorization header is either empty or isn't Basic.");{const e=t.split(" ")[1],r=Buffer.from(e,"base64").toString().split(":"),o=r[0],n=r[1];console.log(`request from ${o} with password:${n}`)}e.ok({node:o,query:r,comment:" node was requested!"})}}},function(e,r,o){const t=new(o(0)),n=o(5);t.get("/",n.getNode),e.exports=t.routes()},function(e,r){e.exports={getUser:function(e){const{query:r}=e.request,{user:o}=r;e.ok({user:o,query:r,comment:" user was requested!"})}}},function(e,r,o){const t=new(o(0)),n=o(7);t.get("/",n.getUser),e.exports=t.routes()},function(e,r,o){const t=o(8),n=o(6);e.exports=(e=>{e.prefix("/v1"),e.use("/users",t),e.use("/nodes",n)})},function(e,r){e.exports=require("koa-respond")},function(e,r){e.exports=require("koa-helmet")},function(e,r){e.exports=require("koa-bodyparser")},function(e,r,o){"use strict";e.exports=function(e){return e=Object.assign({},{allowMethods:"GET,HEAD,PUT,POST,DELETE,PATCH"},e),Array.isArray(e.exposeHeaders)&&(e.exposeHeaders=e.exposeHeaders.join(",")),Array.isArray(e.allowMethods)&&(e.allowMethods=e.allowMethods.join(",")),Array.isArray(e.allowHeaders)&&(e.allowHeaders=e.allowHeaders.join(",")),e.maxAge&&(e.maxAge=String(e.maxAge)),e.credentials=!!e.credentials,e.keepHeadersOnError=void 0===e.keepHeadersOnError||!!e.keepHeadersOnError,function(r,o){const t=r.get("Origin");if(r.vary("Origin"),!t)return o();let n;if("function"==typeof e.origin){if(!(n=e.origin(r)))return o()}else n=e.origin||t;const s={};function i(e,o){r.set(e,o),s[e]=o}if("OPTIONS"!==r.method)return i("Access-Control-Allow-Origin",n),!0===e.credentials&&i("Access-Control-Allow-Credentials","true"),e.exposeHeaders&&i("Access-Control-Expose-Headers",e.exposeHeaders),e.keepHeadersOnError?o().catch(e=>{throw e.headers=Object.assign({},e.headers,s),e}):o();{if(!r.get("Access-Control-Request-Method"))return o();r.set("Access-Control-Allow-Origin",n),!0===e.credentials&&r.set("Access-Control-Allow-Credentials","true"),e.maxAge&&r.set("Access-Control-Max-Age",e.maxAge),e.allowMethods&&r.set("Access-Control-Allow-Methods",e.allowMethods);let t=e.allowHeaders;t||(t=r.get("Access-Control-Request-Headers")),t&&r.set("Access-Control-Allow-Headers",t),r.status=204}}}},function(e,r){e.exports=require("koa-logger")},function(e,r){e.exports=require("koa-basic-auth")},function(e,r){e.exports=require("koa")},function(e,r,o){const t=o(16),n=o(0),s=o(15),i=(o(14),o(13)),c=o(12),u=o(11),a=o(10),l=new t,f=new n;l.use(u()),l.use(async(e,r)=>{try{await r()}catch(r){if(401!==r.status)throw r;e.status=401,e.set("WWW-Authenticate","Basic"),e.body="access was not authorized"}}),l.use(s({name:"jf",pass:"jfhjfh"})),l.use(i()),l.use(c({enableTypes:["json"],jsonLimit:"5mb",strict:!0,onerror(e,r){r.throw("body parse error",422)}})),l.use(a()),o(9)(f),l.use(f.routes()),l.use(f.allowedMethods()),e.exports=l},function(e,r){e.exports=require("dotenv")},function(e,r,o){o(18).config();const t=o(17),n=o(4),{CronJob:s}=o(3),i=o(2).parseArgs()||{},{configPath:c="./fTbus.config.json"}=i;c.endsWith(".json")||console.error("You must provide a json file for the configuration!");const u=e=>{try{return JSON.parse(n.readFileSync(e,"utf8"))}catch(e){return console.error(e),e}},a=u(c),{scanModes:l,configExemple:f}=a;u(l)||console.error("Frequences file not found.");const d=process.env.PORT||3333;t.listen(d,()=>console.info(`API server started on ${d}`))}]);