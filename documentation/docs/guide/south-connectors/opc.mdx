import ThrottlingSettings from './_throttling-settings.mdx';

# OPC Classic™

Connect to OPC Classic™ servers using OIBus with the [OIBus Agent](../oibus-agent/installation.mdx).

:::info Technology Context

- Industrial communication protocol by [OPC Foundation](https://opcfoundation.org/)
- Supports both HDA and DA mode
- Requires Windows-based OIBus Agent
- For OPC UA, see [OPC UA connector](./opcua.mdx)

:::

:::caution System Requirements
OIBus Agent **must** be installed on a Windows machine
:::

## Specific Settings

| Setting          | Description                                | Example Value               |
| ---------------- | ------------------------------------------ | --------------------------- |
| Remote agent URL | Agent endpoint (e.g., `http://host:2224`)  | `http://192.168.1.100:2224` |
| Retry interval   | Time (ms) before connection retry          | 10000                       |
| Server URL       | Address of OPC server (from agent machine) | `localhost` or IP address   |
| Server name      | OPC server name (ProgID)                   | `Matrikon.OPC.Simulation`   |
| Mode             | Data access mode (DA or HDA)               | `HDA`                       |

<ThrottlingSettings />

## Item Settings

| Setting    | Description                                                                   | Options/Examples                            |
| ---------- | ----------------------------------------------------------------------------- | ------------------------------------------- |
| Node ID    | Path to data in OPC server namespace                                          | `Channel1.Device1.Tag1`                     |
| Aggregate  | Data aggregation method (verify server support)                               | `Raw`, `Average`, `Minimum`, `Maximum`, ... |
| Resampling | Resample aggregated values at requested interval (requires non-Raw aggregate) | `None`, `1s`, `10s`, `1h`, ...              |

:::caution Compatibility Notes

1. **Aggregation Support**: Not all servers support all aggregation methods
2. **Resampling**: Only available when aggregate ≠ `Raw`
3. **Recommended Settings**: Use `Raw` aggregation and `None` resampling for maximum compatibility
4. **Server Capabilities**: Verify supported features with your OPC server documentation

:::

### Configuration Examples

1. **Basic Configuration**:

- Node ID: `Simulation Random.Int4`
- Aggregate: `Raw`
- Resampling: `None`

2. **Aggregated Values**:

- Node ID: `Production.Line1.Temperature`
- Aggregate: `Average`
- Resampling: `5m`

3. **High-Frequency Data**:

- Node ID: `Process.Vessel.Pressure`
- Aggregate: `Minimum`
- Resampling: `1s`
