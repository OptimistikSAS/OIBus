import DownloadButton from "../../../src/components/DownloadButton";
import packageInfo from '../../../package.json'
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs>
  <TabItem value="windows-installer" label="Installer" default>
    <div>
      ## Download
    </div>
    <div style={{ display: "flex", justifyContent: "space-around" }}>
      <DownloadButton link={`https://github.com/OptimistikSAS/OIBus/releases/download/v${packageInfo.version}/oibus-setup-win_x64-v${packageInfo.version}.exe`}>
        <div>
          <div>{`OIBus v${packageInfo.version} (installer)`}</div>
          <div>Windows (x64)</div>
        </div>
      </DownloadButton>
    </div>
    <div>
      ## Installation steps
      1. Run the Windows Installer, you should see the following welcome screen:

      <div style={{ textAlign: 'center' }}>

        ![Installer welcome screen](../../../static/img/guide/installation/win_installer/1.png)

      </div>


      2. Accept the EU-PL license.

      3. Choose the path where you want to install the binaries.

      <div style={{ textAlign: 'center' }}>

        ![Installer binaries path](../../../static/img/guide/installation/win_installer/2.png)

      </div>

      4. Select the directory where you'd like to store the cache, logs, and configuration files.

      <div style={{ textAlign: 'center' }}>

        ![Installer data folder path](../../../static/img/guide/installation/win_installer/3.png)

      </div>

      5. Confirm the settings and await the installer to extract and copy the files to the designated folder.

      <div style={{ textAlign: 'center' }}>

        ![Installer validation step](../../../static/img/guide/installation/win_installer/4.png)

      </div>

      6. The last screen will confirm the completion of the installation process.

      Get familiar with the OIBus interface on the [first access page](./first-access.mdx).
    </div>
    <div>
      ## Uninstall
      Navigate to the binary folder and execute the `unin000.exe` file with administrative privileges.

      <div style={{ textAlign: 'center' }}>

        ![Installer binaries path](../../../static/img/guide/installation/win_uninstall/1.png)

      </div>

      <div style={{ textAlign: 'center' }}>

        ![Installer binaries path](../../../static/img/guide/installation/win_uninstall/2.png)

      </div>
    </div>
    <div>
      ## Update
      If you wish to update OIBus, you can utilize the OIBus Windows Installer and indicate the current executable and configuration
      paths. You have the option to retain the existing configuration file or replace it.

      During the update process, the OIBus service will experience a brief interruption.

      Upon the initial startup after the update, the configuration database `oibus.db` will be automatically upgraded to the
      latest version.
    </div>
  </TabItem>

  <TabItem value="windows-scripts" label="Scripts">
    <div>
      ## Download
    </div>
    <div style={{ display: "flex", justifyContent: "space-around" }}>
      <DownloadButton link={`https://github.com/OptimistikSAS/OIBus/releases/download/v${packageInfo.version}/oibus-win_x64-v${packageInfo.version}.zip`}>
        <div>
          <div>{`OIBus v${packageInfo.version} (zip)`}</div>
          <div>Windows (x64)</div>
        </div>
      </DownloadButton>
    </div>
    <div>
      ## Installation steps
      ``` commandline title="Usage"
      install.bat -c=<data-path>
      ```

      ``` commandline title="Example with terminal outputs"
      install.bat -c="C:\OIBusData"
      > Administrator permissions required. Detecting permission...
      > Stopping OIBus service...
      > Installing OIBus as Windows service...
      > The "OIBus" service has been successfully installed!
      > Configuration of the "AppDirectory" parameter value for the "OIBus" service.
      > nssm set OIBus AppNoConsole 1
      > Starting OIBus service...
      > OIBus: START: Operation successful.
      > Creating go.bat
      > echo Stopping OIBus service... You can restart it from the Windows Service Manager
      > nssm.exe stop OIBus
      > "C:\Users\Administrator\Downloads\oibus-win_x64\oibus.exe" --config "C:\OIBusData"
      ```

      :::tip
      If you do not provide the data path argument, the script will prompt you to input it during execution. You can also
      provide the -n="OIBus Name" argument to change the name of the OIBus service.
      :::

      Get familiar with the OIBus interface on the [first access page](./first-access.mdx).
    </div>
    <div>
      ## Uninstall
      ```` title="Example with terminal outputs"
      uninstall.bat
      Administrator permissions required. Detecting permission...
      Stopping OIBus service...
      Removing OIBus service...
      ````

      :::caution
      The data folder must be removed manually.
      :::
    </div>
    <div>
      ## Update
      After extracting the files from the zip archive:
      1. Open the Windows Service Manager.
      2. Halt the OIBus service.
      3. Copy and paste the contents of the zip file into the OIBus executable directory, replacing any existing files.
      4. Resume the OIBus service.

      Upon the initial startup after the update, the configuration database `oibus.db` will be automatically upgraded to the
      latest version.
    </div>
  </TabItem>
</Tabs>
