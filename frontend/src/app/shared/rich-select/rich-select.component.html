<div
  ngbDropdown
  container="body"
  [placement]="['bottom-left', 'top-left']"
  (openChange)="openChanged($event, button)"
  #dropdown="ngbDropdown"
>
  <button
    #button
    type="button"
    [disabled]="disabled"
    (blur)="touched()"
    class="form-select"
    [class.form-select-sm]="isSmall"
    ngbDropdownToggle
  >
    @if (selectedLabel) {
      <span>{{ selectedLabel }}</span>
    } @else {
      <span class="placeholder">{{ placeholder }}</span>
    }
  </button>
  <div ngbDropdownMenu (keyup.esc)="dropdown.close(); $event.stopPropagation()">
    @for (option of options; track option) {
      <button
        type="button"
        ngbDropdownItem
        (click)="select(option, $event)"
        [class.selected]="isSelected(option)"
        (keydown.esc)="$event.stopPropagation()"
      >
        <!-- Option has custom content -->
        <div class="rich-content-wrapper" #richContentWrapper>
          <ng-container *ngTemplateOutlet="option.contentTemplateRef"></ng-container>
        </div>

        <!-- Option does not have custom content, just showing label -->
        @if (!richContentWrapper.children.length) {
          {{ option.label }}
        }
      </button>
    }
  </div>
</div>
