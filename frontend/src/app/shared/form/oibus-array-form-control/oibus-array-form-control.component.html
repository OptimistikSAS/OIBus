<oib-box class="mt-1">
  <ng-template oibBoxTitle>
    <div class="d-flex justify-content-between align-items-center">
      <div [translate]="arrayAttribute().rootAttribute.translationKey"></div>
      <div class="ms-3">
        <button
          type="button"
          class="btn btn-primary btn-sm oib-box-btn"
          [ngbTooltip]="'configuration.oibus.edit-array-element-modal.tooltips.add' | translate"
          (click)="addElement($event)"
          id="oibus-array-add-element-button"
        >
          <span class="fa fa-plus"></span>
        </button>
        <button
          type="button"
          class="btn btn-secondary btn-sm oib-box-btn"
          (click)="exportArray()"
          [disabled]="!control().value.length"
          translate="south.items.export.button"
        ></button>
        <button
          type="button"
          class="btn btn-secondary btn-sm oib-box-btn"
          (click)="importArray()"
          translate="south.items.import.button"
        ></button>
      </div>
    </div>
  </ng-template>

  @if (arrayAttribute().paginate && paginatedValues().totalPages > 1) {
    <div>
      <oib-pagination class="d-flex justify-content-end" [page]="paginatedValues()" (pageChanged)="paginatedValues().gotoPage($event)" />
    </div>
  }
  @if (control().value.length > 0) {
    <table style="table-layout: fixed" class="table table-sm table-hover">
      <thead>
        <tr>
          @for (column of columns(); track column.translationKey) {
            @if (column.type === 'string-select') {
              <th>{{ column.translationKey + '.title' | translate }}</th>
            } @else {
              <th>{{ column.translationKey | translate }}</th>
            }
          }
          <th></th>
        </tr>
      </thead>
      <tbody>
        @for (element of arrayAttribute().paginate ? paginatedValues().content : control().value; track element) {
          <tr>
            @for (column of columns(); track column.translationKey) {
              <td style="text-overflow: ellipsis; overflow: hidden; white-space: nowrap">
                {{ formatValue(element, column.path, column.type, column.translationKey) }}
              </td>
            }
            <td class="text-nowrap text-end">
              <button
                type="button"
                class="btn btn-sm btn-link btn-link-bold edit-button px-1 py-0"
                [ngbTooltip]="'configuration.oibus.edit-array-element-modal.tooltips.edit' | translate"
                (click)="editElement(element)"
              >
                <span class="fa fa-pencil"></span>
              </button>
              <button
                type="button"
                class="btn btn-sm btn-link btn-link-bold copy-button px-1 py-0"
                [ngbTooltip]="'configuration.oibus.edit-array-element-modal.tooltips.copy' | translate"
                (click)="copyElement(element)"
              >
                <span class="fa fa-copy"></span>
              </button>
              <button
                type="button"
                class="btn btn-sm btn-link btn-link-bold delete-button px-1 py-0"
                [ngbTooltip]="'configuration.oibus.edit-array-element-modal.tooltips.delete' | translate"
                (click)="deleteElement(element)"
              >
                <span class="fa fa-trash"></span>
              </button>
            </td>
          </tr>
        }
      </tbody>
    </table>
  } @else {
    <div class="oi-details" translate="configuration.oibus.manifest.south.items.no-items"></div>
  }
  <val-errors [controlName]="arrayAttribute().key" />
</oib-box>
